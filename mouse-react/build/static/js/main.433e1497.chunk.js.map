{"version":3,"sources":["js/modules/Home.js","js/util/Rules.js","js/util/System.js","js/util/SocketUtil.js","js/util/GameUtil.js","js/modules/canvas/CanvasUtil.js","js/modules/ui/Lobby.js","js/modules/canvas/Canvas.js","js/modules/Room.js","App.js","reportWebVitals.js","index.js"],"names":["INPUT_CSS","Home","name","setName","room","useParams","useState","navigate","setNavigate","code","setCode","useEffect","document","title","handleKeyPress","event","key","to","className","type","placeholder","onChange","target","value","onKeyPress","autoFocus","DEFAULTS","GRID","WIDTH","HEIGHT","STEP","Math","floor","console","warn","HOME_URL","STRIPPED_HOME_URL","replace","log","process","SOCKET","io","transports","canvasUtil","this","canvas","ctx","img","Image","update","colors","clear","rect","canvasRef","current","parent","parentElement","getContext","fillStyle","fillRect","w","h","toDataURL","data","onload","drawImage","width","height","src","requestAnimationFrame","render","x","y","color","c","PLAYER","id","position","alive","PLAYERS","BLOCKS","PICKUPS","LIMIT","PAUSED","isPlayerBlockColliding","block","playerX","playerY","BETWEEN_X","BETWEEN_Y","isTouching","item1","item2","SAME_SPOT","UP_SPOT","DOWN_SPOT","LEFT_SPOT","RIGHT_SPOT","setPlayerPositions","players","onDeath","handlePlayerDeath","setPause","bool","LAST","ELAPSED","animate","time","pickupKeys","Object","keys","i","length","p","handlePickups","player","handlePlayers","drawPlayer","handleOutOfBounds","elapsed","velocity","age","handleBlocks","Lobby","children","handleChange","map","isPlayer","style","selected","picker","nickname","Canvas","onMouseMove","onKey","zoomMultiplier","useRef","focus","init","setCanvas","transform","clientX","clientY","offsetTop","offsetLeft","onKeyDown","onContextMenu","preventDefault","tabIndex","ref","Room","view","setView","host","setHost","setPlayers","setColor","setAlive","setZoomMultiplier","shake","setShake","endScreenMsg","setEndScreenMsg","endScreenVisible","setEndScreenVisible","emit","on","response","end","message","playersList","difficulty","game","blocks","pickups","limit","handleDeath","handleStart","handleKey","setKeys","handleColorChange","setPlayerColor","setTimeout","handleEndScreen","classNames","onClick","App","path","element","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.433e1497.chunk.js","sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { Link, useParams, Navigate } from 'react-router-dom';\r\n\r\nconst INPUT_CSS = \"text-input large bold\";\r\n\r\n/*\r\n  Display home screen\r\n  - prompt user for display name\r\n  - prompt user for room code if prompted\r\n*/\r\nconst Home = ({ name, setName }) => {\r\n  const { room } = useParams();\r\n  const [navigate, setNavigate] = useState(null);\r\n  const [code, setCode] = useState(room);\r\n\r\n  useEffect(() => {\r\n    document.title = room || \"block\";\r\n  }, [room]);\r\n\r\n  const handleKeyPress = (event) => {\r\n    if((event.key === \"Enter\") && name && code) {\r\n      setNavigate(<Navigate to={`/${code}`}/>)\r\n    }\r\n  }\r\n\r\n  if(navigate) return navigate;\r\n  return (\r\n    <div className=\"home\">\r\n      <input \r\n        className={INPUT_CSS} \r\n        type=\"text\" \r\n        placeholder=\"name\"\r\n        onChange={(event) => { setName(event.target.value )}} \r\n        onKeyPress={room ? handleKeyPress : null}\r\n        autoFocus\r\n      />\r\n      { !room &&\r\n        <input \r\n          className={INPUT_CSS + (name || code ? \"\" : \" hide\")} \r\n          type=\"text\" \r\n          placeholder=\"room code\" \r\n          onChange={(event) => { setCode(event.target.value) }} \r\n          onKeyPress={room ? handleKeyPress : null}\r\n        />\r\n      }\r\n      <Link className={\"round-btn medium\" + (name && code ? \"\" : \" hide\")} to={`/${code}`}> join </Link> \r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Home;","export const DEFAULTS = {\r\n  WIDTH               : 735,\r\n  HEIGHT              : 735,\r\n  STEP                : 15,\r\n  COLOR               : \"#3c3cff\",\r\n  MAX_AGE             : 500\r\n}\r\n\r\nexport const GRID = {\r\n  WIDTH   : DEFAULTS.WIDTH / DEFAULTS.STEP,\r\n  HEIGHT  : DEFAULTS.HEIGHT / DEFAULTS.STEP,\r\n  STEP    : DEFAULTS.STEP\r\n}\r\n\r\nexport const SPAWN = {\r\n  x : Math.floor(GRID.WIDTH / 2) * GRID.STEP,\r\n  y : Math.floor(GRID.HEIGHT / 2) * GRID.STEP\r\n}\r\n\r\nif(DEFAULTS.WIDTH % DEFAULTS.STEP || DEFAULTS.WIDTH % DEFAULTS.STEP) {\r\n  console.warn(\"Height or width must be divisible by step\");\r\n}","const DEV = process.env.REACT_APP_DEV;\r\n\r\nconst LOCAL_CLIENT = \"http://localhost:3000\";\r\nconst LOCAL_SERVER = \"http://localhost:3300\";\r\n\r\nconst DEPLOYED = \"https://block10.herokuapp.com\";\r\n\r\nexport const HOME_URL = DEV ? LOCAL_CLIENT : DEPLOYED;\r\nexport const SERVER_URL = DEV ? LOCAL_SERVER : DEPLOYED;\r\n\r\nexport const STRIPPED_HOME_URL = HOME_URL?.replace(\"http://\",\"\").replace(\"https://\",\"\");\r\n\r\nconsole.log(process.env);","import io from 'socket.io-client';\r\nimport { SERVER_URL } from './System.js';\r\n\r\nconst DOMAIN = SERVER_URL;\r\n\r\nexport const SOCKET = io(DOMAIN, { transports: ['websocket']});","import { DEFAULTS, GRID } from './Rules.js';\r\nimport CanvasUtil from '../modules/canvas/CanvasUtil.js';\r\nconst canvasUtil = new CanvasUtil();\r\n\r\n\r\nlet PLAYER = { id: null, position: { x : null, y : null}, color: DEFAULTS.COLOR, alive: true }\r\nlet PLAYERS = {};\r\nlet BLOCKS = {};\r\nlet PICKUPS = {};\r\nlet LIMIT = 0;\r\n\r\n\r\nlet PAUSED = false;\r\n\r\n\r\nexport const reset = () => {\r\n  PLAYER = { ...PLAYER, alive: true };\r\n  BLOCKS = {};\r\n  PICKUPS = {};\r\n  LIMIT = 0;\r\n}\r\n\r\n/*** CANVAS ***/\r\n\r\nexport const setCanvas = (canvasRef) => {\r\n  canvasUtil.init(canvasRef);\r\n  canvasUtil.clear();\r\n}\r\n\r\nexport const drawPlayer = () => {\r\n  if(!PLAYER.alive) return;\r\n\r\n  const { x, y } = PLAYER.position;\r\n  canvasUtil.rect(x, y, GRID.STEP, GRID.STEP, PLAYER.color);\r\n}\r\n\r\nexport const drawBlock = (block) => {\r\n  canvasUtil.rect(block.x, block.y, block.width, block.height, block.color);\r\n}\r\n\r\n\r\n/*** HANDLERS ***/\r\n\r\n// moves blocks and checks if they're expired\r\nconst handleBlocks = (elapsed) => {\r\n  const keys = Object.keys(BLOCKS);\r\n  if(keys.length > 100) console.log(\"BLOCKS array is getting quite large! @ \", keys.length);\r\n  \r\n  for(var i = 0; i < keys.length; i++) {\r\n    const key = keys[i];\r\n    BLOCKS[key].x += BLOCKS[key].velocity.x * elapsed;\r\n    BLOCKS[key].y += BLOCKS[key].velocity.y * elapsed;\r\n    BLOCKS[key].age += elapsed;\r\n    \r\n    drawBlock(BLOCKS[key]);\r\n    if(isPlayerBlockColliding(BLOCKS[key])) handlePlayerDeath();\r\n    if(BLOCKS[key].age > DEFAULTS.MAX_AGE) delete BLOCKS[key];\r\n  }\r\n}\r\n\r\nconst handlePlayers = () => {\r\n  for(const p in PLAYERS) {\r\n    const player = PLAYERS[p];\r\n    \r\n    if(PLAYER.id !== player.id && player.alive) {\r\n      if(isTouching(player.position, PLAYER)) console.log(\"TOUCHING PLAYERS\");\r\n      canvasUtil.rect(player.position.x, player.position.y, GRID.STEP, GRID.STEP, player.color);\r\n    }\r\n  }\r\n}\r\n\r\n// check if a player activates a pickup\r\nconst handlePickups = () => {\r\n  const pickupKeys = Object.keys(PICKUPS);\r\n  for(var i = 0; i < pickupKeys.length; i++) {\r\n    const p = pickupKeys[i];\r\n    const { x, y, color } = PICKUPS[p];\r\n    canvasUtil.rect(x, y, GRID.STEP, GRID.STEP, color);\r\n  }\r\n}\r\n\r\n// check if player is out of bounds\r\nconst handleOutOfBounds = () => {\r\n  const playerX = PLAYER.position.x;\r\n  const playerY = PLAYER.position.y;\r\n  \r\n  const BELOW_X = playerX < (LIMIT * GRID.STEP);\r\n  const ABOVE_X = playerX >= DEFAULTS.WIDTH - (LIMIT * GRID.STEP);\r\n\r\n  const BELOW_Y = playerY < (LIMIT * GRID.STEP);\r\n  const ABOVE_Y = playerY >= DEFAULTS.HEIGHT - (LIMIT * GRID.STEP);\r\n  if(BELOW_X || ABOVE_X || BELOW_Y || ABOVE_Y) handlePlayerDeath();\r\n}\r\n\r\n\r\n// checks if a block is colliding with the player\r\nconst isPlayerBlockColliding = (block) => {\r\n  const playerX = PLAYER.position.x;\r\n  const playerY = PLAYER.position.y;\r\n\r\n  const BETWEEN_X = block.x <= playerX && playerX < block.x + block.width;\r\n  const BETWEEN_Y = block.y <= playerY && playerY < block.y + block.height;\r\n  return BETWEEN_X && BETWEEN_Y;\r\n}\r\n\r\n// checks if two items of the same size are touching (e.g pickups and players)\r\nconst isTouching = (item1, item2) => {\r\n  const SAME_SPOT = (item1.x === item2.x) && (item1.y === item2.y);\r\n  const UP_SPOT = (item1.x === item2.x) && (item1.y - GRID.STEP === item2.y);\r\n  const DOWN_SPOT = (item1.x === item2.x) && (item1.y + GRID.STEP === item2.y);\r\n  const LEFT_SPOT = (item1.x - GRID.STEP === item2.x) && (item1.y === item2.y);\r\n  const RIGHT_SPOT = (item1.x + GRID.STEP === item2.x) && (item1.y === item2.y);\r\n\r\n  return SAME_SPOT || UP_SPOT || DOWN_SPOT || LEFT_SPOT || RIGHT_SPOT;\r\n}\r\n\r\n\r\n/*** SETTERS ***/\r\n\r\n\r\nexport const setPlayer = (player) => {\r\n  PLAYER = { ...PLAYER, ...player};\r\n}\r\n\r\nexport const setPlayerColor = (color) => {\r\n  PLAYER.color = color;\r\n}\r\n\r\nexport const setPlayerSpawn = (position) => {\r\n  PLAYER.position = position;\r\n}\r\n\r\nexport const setKeys = (key) => {\r\n  if(!PLAYER.alive || PAUSED) return;\r\n  \r\n  if(key === \"w\" || key === \"ArrowUp\") PLAYER.position.y -= GRID.STEP;\r\n  if(key === \"s\" || key === \"ArrowDown\") PLAYER.position.y += GRID.STEP;\r\n  if(key === \"a\" || key === \"ArrowLeft\") PLAYER.position.x -= GRID.STEP;\r\n  if(key === \"d\" || key === \"ArrowRight\") PLAYER.position.x += GRID.STEP;\r\n  return PLAYER.position;\r\n}\r\n\r\nexport const setPlayerPositions = (players) => {\r\n  PLAYERS = players;\r\n}\r\n\r\nexport const setGame = (game) => {\r\n  BLOCKS = {...game?.blocks, ...BLOCKS};\r\n  PICKUPS = game?.pickups;\r\n  LIMIT = game?.limit;\r\n}\r\n\r\n\r\n\r\n/*** DEATH ***/\r\n\r\nlet onDeath = null;\r\n\r\nexport const setOnDeath = (func) => {\r\n  onDeath = func;\r\n}\r\n\r\nconst handlePlayerDeath = () => {\r\n  if(!PLAYER.alive) return;\r\n\r\n  PLAYER.alive = false;\r\n  if(onDeath) onDeath();\r\n}\r\n\r\n\r\n\r\n/*** GAMELOOP ***/\r\n\r\n\r\nexport const setPause = (bool) => {\r\n  PAUSED = bool\r\n}\r\n\r\nlet LAST = 0, ELAPSED = 0;\r\nexport const animate = () => {\r\n  const render = (time) => {\r\n    ELAPSED = (time - LAST) / 16;\r\n    LAST = time;\r\n\r\n    if(!PAUSED)  {\r\n      canvasUtil.clear();\r\n      handlePickups();\r\n      handlePlayers();\r\n      drawPlayer();\r\n      handleOutOfBounds();\r\n      handleBlocks(ELAPSED);\r\n    }\r\n\r\n    // canvasUtil.rect(LIMIT * GRID.STEP, LIMIT * GRID.STEP, DEFAULTS.WIDTH - (LIMIT * GRID.STEP * 2), DEFAULTS.WIDTH - (LIMIT * GRID.STEP * 2), \"rgb(0,0,0,.3)\");\r\n\r\n    requestAnimationFrame(render);\r\n  }\r\n\r\n  requestAnimationFrame(render);\r\n}","class CanvasUtil {\r\n  constructor() {\r\n    this.canvas = null;\r\n    this.ctx = null;\r\n\r\n    this.img = new Image();\r\n    this.update = false;\r\n\r\n    this.colors = {\r\n      clear: \"WHITE\",\r\n      rect: \"BLACK\"\r\n    }\r\n  }\r\n\r\n  /*\r\n    canvasRef : react ref to canvas element\r\n  */\r\n  init(canvasRef) {\r\n    if(!canvasRef?.current) {\r\n      console.log(\"Could not initialize Canvas\");\r\n      return;\r\n    }\r\n    \r\n    console.log(\"Initializing Canvas\");\r\n    \r\n    this.canvas = canvasRef.current;\r\n    this.parent = canvasRef.current.parentElement;\r\n    this.ctx = this.canvas.getContext(\"2d\");\r\n\r\n    this.clear();\r\n  }\r\n\r\n  clear() {\r\n    if(!this.canvas) return;\r\n\r\n    this.ctx.fillStyle = this.colors.clear;\r\n    this.ctx.fillRect(0,0, this.w(), this.h())\r\n  }\r\n\r\n\r\n  getData() {\r\n    if(!this.canvas) return;\r\n    return this.canvas.toDataURL();\r\n  }\r\n\r\n  setData(data) {\r\n    if(!this.canvas) return;\r\n\r\n    var img = new Image();\r\n    img.onload = () => {\r\n      this.ctx.drawImage(img, 0, 0, this.canvas.width, this.canvas.height);\r\n    }\r\n    this.img.src = data;\r\n\r\n    this.update = true;\r\n  }\r\n\r\n  draw() {\r\n    if(!this.canvas) return;\r\n\r\n    const render = () => {\r\n        if(this.update){  // only raw if needed\r\n          this.update = false;\r\n          this.ctx.drawImage(this.img, 0, 0, this.canvas.width, this.canvas.height);\r\n        }\r\n        requestAnimationFrame(render);\r\n    }\r\n    requestAnimationFrame(render);\r\n  }\r\n  \r\n  rect(x, y, width, height, color) {\r\n    this.ctx.fillStyle = color || this.colors.rect ;\r\n    this.ctx.fillRect(x, y, width, height);\r\n  }\r\n  \r\n  w() { return this.canvas.width; }\r\n  h() { return this.canvas.height }\r\n\r\n  setColors(c) {\r\n    this.colors = { ...this.colors, ...c};\r\n  }\r\n}\r\n\r\nexport default CanvasUtil;","const Lobby = ({ id, players, children, color, onChange }) => {\r\n  const handleChange = (event) => {\r\n    if(onChange) onChange(event.target.value);\r\n  }\r\n\r\n  \r\n  return (\r\n    <div className=\"lobby flex-col flex-fill\">\r\n      <div className=\"player-list flex-col\"> \r\n        { players?.map((p) => {\r\n          const isPlayer = p.id === id;\r\n          const style = isPlayer ? { color } : null;\r\n          const selected = isPlayer ? \" bold\" : \"\";\r\n          const picker = isPlayer  ? (\r\n            <span> <input type=\"color\" value={color} onChange={handleChange}/> </span>\r\n          ) : null;\r\n            return <label className={\"flex medium\" + selected} key={p.id} style={style}> {p.nickname} {picker} </label> \r\n          }\r\n        )}\r\n      </div>\r\n      {children}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Lobby;","import { useEffect, useRef } from 'react';\r\n\r\nimport { animate, setCanvas } from '../../util/GameUtil.js';\r\nimport { DEFAULTS } from '../../util/Rules.js';\r\n\r\nconst Canvas = ({ width, height, onMouseMove, onKey, zoomMultiplier, className}) => {\r\n  const canvasRef = useRef(null);\r\n  const position = useRef(null);\r\n\r\n  useEffect(() => {\r\n    if(!canvasRef.current) return;\r\n    \r\n    canvasRef.current.focus();\r\n    setCanvas(canvasRef);\r\n    animate();\r\n  }, [width, height])\r\n\r\n  const handleMouseMove = (event) => {\r\n    if(!onMouseMove) return;\r\n\r\n    const { clientX, clientY } = event;\r\n    const { offsetTop, offsetLeft } = event.target;\r\n\r\n    const x = clientX - offsetLeft\r\n    const y = clientY - offsetTop;\r\n\r\n    position.current = { x, y };\r\n    if(onMouseMove) onMouseMove(position.current);\r\n  }\r\n\r\n  const handleKeyDown = (event) => {\r\n    if(onKey) onKey(event.key);\r\n  }\r\n\r\n  const prevent = (event) => { event.preventDefault() }\r\n\r\n  const scale = DEFAULTS.WIDTH / (DEFAULTS.WIDTH - zoomMultiplier * DEFAULTS.STEP * 2);\r\n  const style = {\r\n   transform: `scale(${scale})`\r\n  }\r\n\r\n  return (\r\n    <div className=\"canvas-wrapper\">\r\n      <canvas \r\n        className={className || \"\"}\r\n        width={DEFAULTS.WIDTH} \r\n        height={DEFAULTS.HEIGHT} \r\n        onMouseMove={handleMouseMove}\r\n        onKeyDown={handleKeyDown}\r\n        onContextMenu={prevent}\r\n        tabIndex={1}\r\n        ref={canvasRef}\r\n        style={style}\r\n      />\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Canvas;","import { useState, useEffect } from 'react';\r\nimport { useParams, Navigate } from 'react-router-dom';\r\n\r\nimport { DEFAULTS } from '../util/Rules.js';\r\n\r\nimport { STRIPPED_HOME_URL } from '../util/System.js';\r\nimport { SOCKET } from '../util/SocketUtil.js';\r\n\r\nimport { reset, setPlayer, setPlayerSpawn, setPlayerColor, setKeys, setPlayerPositions, setGame, setOnDeath, setPause } from '../util/GameUtil.js';\r\n\r\nimport Lobby from './ui/Lobby.js';\r\nimport Canvas from './canvas/Canvas.js';\r\n\r\nconst Room = ({ name }) => {\r\n  const { room } = useParams();\r\n  \r\n  const [view, setView] = useState(0);\r\n  const [host, setHost] = useState(null);\r\n  const [players, setPlayers] = useState(null);\r\n  const [color, setColor] = useState(DEFAULTS.COLOR);\r\n  \r\n  const [alive, setAlive] = useState(null);\r\n  const [zoomMultiplier, setZoomMultiplier] = useState(0);\r\n  const [shake, setShake] = useState(null);\r\n\r\n  const [endScreenMsg, setEndScreenMsg] = useState(null);\r\n  const [endScreenVisible, setEndScreenVisible] = useState(false);\r\n  \r\n  useEffect(() => {\r\n    if(!name) return;\r\n\r\n    SOCKET.emit('SET_NICK', name);\r\n    SOCKET.emit('JOIN_ROOM', room);\r\n\r\n    SOCKET.on('START_GAME', () => {\r\n      setView(1);\r\n      setEndScreenVisible(false);\r\n      setPause(false);\r\n    });\r\n\r\n    SOCKET.on('ROOM_UPDATE', (response) => {\r\n      if(response.end) {\r\n        setEndScreenMsg(response.message)\r\n        setPause(true);\r\n        setEndScreenVisible(true);\r\n        reset();\r\n      }\r\n  \r\n      setHost(response?.host);\r\n      setPlayers(response?.playersList);\r\n  \r\n      setPlayerPositions(response?.players);\r\n      setPlayerSpawn(response?.players[SOCKET.id]?.position);\r\n      if(response?.difficulty > 0) setView(1);\r\n    });\r\n\r\n    SOCKET.on('GENERATION', (response) => {\r\n      setGame(response);\r\n      setZoomMultiplier(response?.limit);\r\n      setAlive(response?.alive);\r\n    });\r\n\r\n    SOCKET.on('POSITIONS', setPlayerPositions);\r\n    \r\n  }, [room, name]);\r\n\r\n  useEffect(() => {\r\n    setPlayer({ id: SOCKET.id });\r\n    setOnDeath(handleDeath);\r\n  }, []);\r\n\r\n  const handleStart = () => {\r\n    SOCKET.emit('START_GAME');\r\n  }\r\n\r\n  /*\r\n  const handleMouseMove = (position) => {\r\n    setPlayerPosition(position.x, position.y)\r\n    SOCKET.emit('PLAYER_POSITION', position);\r\n  }\r\n  */\r\n\r\n  const handleKey = (key) => {\r\n    const position = setKeys(key);\r\n    if(position) SOCKET.emit('PLAYER_POSITION', position);\r\n  }\r\n\r\n  const handleColorChange = (color) => {\r\n    setColor(color);\r\n    setPlayerColor(color);\r\n    SOCKET.emit(\"PLAYER_COLOR\", color);\r\n  }\r\n\r\n  const handleDeath = () => {\r\n    SOCKET.emit(\"PLAYER_DEATH\");\r\n    setShake(\"animate-shake\");\r\n    setTimeout(() => { setShake(null) }, 500);\r\n  }\r\n\r\n  const handleEndScreen = () => {\r\n    setEndScreenVisible(false);\r\n    setView(0);\r\n    setZoomMultiplier(0);\r\n    setPause(false);\r\n  }\r\n\r\n  const getView = () => {\r\n    if(view === 1) {\r\n      return (\r\n        <>\r\n          { endScreenVisible &&\r\n            <div className=\"end-screen flex-col\">\r\n              <label className=\"huge bold\"> {endScreenMsg} </label>\r\n              <button className=\"round-btn large bold\" onClick={handleEndScreen}> back to lobby </button>\r\n            </div>\r\n          }\r\n          <label className=\"large bold\"> {alive} player{alive > 1 ? \"s\" : \"\"} remaining </label>\r\n          <Canvas className={shake} onKey={handleKey} zoomMultiplier={zoomMultiplier}/>\r\n        </>\r\n      )\r\n    } else {\r\n      return (\r\n        <>\r\n          <label className=\"large bold\"> {STRIPPED_HOME_URL}/{room} </label>\r\n          <Lobby id={SOCKET.id} players={players} color={color} onChange={handleColorChange}>\r\n            { (host?.id === SOCKET.id) &&\r\n              <button className=\"round-btn large bold\" onClick={handleStart}> start </button>\r\n            }\r\n          </Lobby>\r\n        </>\r\n      )\r\n    }\r\n  }\r\n  \r\n  if(!name) return <Navigate to={`/${room}/@`}/>\r\n\r\n  let classNames = \"room flex-col flex-fill\" + (view === 1 ? \" dark\" : \"\");\r\n  return (\r\n    <div className={classNames}>\r\n      {getView()}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Room;","import './css/main.css';\r\n\r\nimport { useState } from 'react';\r\nimport { BrowserRouter, Routes, Route } from 'react-router-dom';\r\n\r\nimport Home from './js/modules/Home.js';\r\nimport Room from './js/modules/Room.js';\r\n\r\nconst App = () => {\r\n  const [name, setName] = useState(null); // user's display name\r\n\r\n  return (\r\n    <div className=\"app\">\r\n      <BrowserRouter>\r\n        <Routes>\r\n          <Route path=\"/\" element={<Home name={name} setName={setName}/>}/>\r\n          <Route path=\"/:room/@\" element={<Home name={name} setName={setName}/>}/>\r\n          <Route path=\"/:room\" element={<Room name={name}/>}/>\r\n        </Routes>\r\n      </BrowserRouter>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","const reportWebVitals = onPerfEntry => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}